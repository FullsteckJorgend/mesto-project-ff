(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}t.d({},{M:()=>j,_:()=>Y});var n="https://nomoreparties.co/v1/wff-cohort-37",r={authorization:"ff9da2f2-3d14-4bf6-b7b2-c2cdca1e46ca","Content-Type":"application/json"};function o(t){return fetch("".concat(n,"/cards/").concat(t),{method:"DELETE",headers:r}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}var c=fetch("".concat(n,"/users/me"),{headers:r}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})),u=fetch("".concat(n,"/cards"),{headers:r}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})),i=document.querySelector("#card-template").content;function a(t,e,n,r,c){var u=i.querySelector(".card").cloneNode(!0),a=u.querySelector(".card__delete-button"),l=u.querySelector(".card__image"),s=u.querySelector(".card__title"),d=u.querySelector(".card__like-button"),p=u.querySelector(".number-of-likes"),f=t.likes.some((function(t){return t._id===c._id}));return l.src=t.link,l.alt=t.name,s.textContent=t.name,p.textContent=t.likes.length,c&&t&&t.owner._id!==c._id?a.remove():a.addEventListener("click",(function(){o(t._id)})),f&&d.classList.add("card__like-button_is-active"),a.addEventListener("click",(function(n){e(n),o(t._id)})),d.addEventListener("click",(function(e){n(e,t._id,p)})),l.addEventListener("click",r),u}function l(t){var e=t.target.closest(".card");e&&e.remove()}function s(t,e,o){var c=function(t){o.textContent=t.likes.length};t.target.classList.contains("card__like-button_is-active")?(function(t){return fetch("".concat(n,"/cards/likes/").concat(t),{method:"DELETE",headers:r}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return t})).catch((function(t){console.log(t)}))}(e).then(c),t.target.classList.remove("card__like-button_is-active")):(function(t){return fetch("".concat(n,"/cards/likes/").concat(t),{method:"PUT",headers:r}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return t})).catch((function(t){console.log(t)}))}(e).then(c),t.target.classList.add("card__like-button_is-active"))}function d(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",f)}function p(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",f)}function f(t){"Escape"===t.key&&p(document.querySelector(".popup_is-opened"))}function _(t,e){t.target===t.currentTarget&&p(e)}function m(t,e,n){e.textContent=t,e.classList.remove("input-error-non-active"),n.setAttribute("style","border-bottom: 1px solid red;")}function y(t,e,n){t.every((function(t){return t.validity.valid}))?(e.classList.remove(n.inactiveButtonClass),e.removeAttribute("disabled")):(e.classList.add(n.inactiveButtonClass),e.setAttribute("disabled",!0))}function v(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),r=t.querySelector(e.submitButtonSelector);n.forEach((function(n){var r=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),r&&(r.textContent="",r.classList.add(e.errorClass)),n.removeAttribute("style")})),r.classList.add(e.inactiveButtonClass),r.setAttribute("disabled",!0)}var h,S,b,g,k=document.querySelectorAll(".popup"),q=document.querySelector(".profile__image"),L=document.querySelector(".profile__title"),E=document.querySelector(".profile__description"),C=document.querySelector(".profile__edit-button"),x=document.querySelector(".profile__add-button"),j=document.querySelector(".places__list"),A=document.querySelector(".popup_type_edit"),P=document.querySelector(".popup_type_new-card"),w=document.querySelector(".popup_type_image"),O=A.querySelector(".popup__form"),T=P.querySelector(".popup__form"),B=document.querySelector(".popup__input_type_name"),D=document.querySelector(".popup__input_type_description"),I=document.querySelector(".popup__input_type_card-name"),M=document.querySelector(".popup__input_type_url"),N=A.querySelector(".popup__close"),J=P.querySelector(".popup__close"),H=w.querySelector(".popup__close"),U=document.querySelector(".popup__image"),z=document.querySelector(".popup__caption"),R=document.querySelector(".popup_type_edit-avatar"),$=R.querySelector(".popup__form"),F=document.querySelector(".profile__image"),G=R.querySelector(".popup__close"),K=R.querySelector(".popup__input"),Q=A.querySelector(".popup__button"),V=P.querySelector(".popup__button"),W=R.querySelector(".popup__button"),X={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"button_disabled",inputErrorClass:"input_error",errorClass:"input-error-non-active"};function Y(t){t.target.classList.contains("card__image")&&(U.src=t.target.src,U.alt=t.target.alt,z.textContent=t.target.alt,d(w))}k.forEach((function(t){return t.classList.add("popup_is-animated")})),C.addEventListener("click",(function(){B.value=L.textContent,D.value=E.textContent,v(O,X),d(A)})),x.addEventListener("click",(function(){v(T,X),d(P)})),F.addEventListener("click",(function(){v($,X),d(R)})),A.addEventListener("click",(function(t){return _(t,A)})),R.addEventListener("click",(function(t){return _(t,R)})),P.addEventListener("click",(function(t){return _(t,P)})),w.addEventListener("click",(function(t){return _(t,w)})),N.addEventListener("click",(function(){return p(A)})),J.addEventListener("click",(function(){return p(P)})),G.addEventListener("click",(function(){return p(R)})),H.addEventListener("click",(function(){return p(w)})),O.addEventListener("submit",(function(t){Q.textContent="Сохранение...",function(t){t.preventDefault(),L.textContent=B.value,E.textContent=D.value,console.log(C.textContent),function(t,e){return fetch("".concat(n,"/users/me"),{method:"PATCH",headers:r,body:JSON.stringify({name:t.textContent,about:e.textContent})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}(L,E).then((function(t){p(A),Q.textContent="Сохранить"})).catch((function(t){console.log(t)}))}(t)})),T.addEventListener("submit",(function(t){V.textContent="Сохранение...",function(t){t.preventDefault();var e,o,c={name:I.value,link:M.value,likes:[]};T.reset(),(e=c.name,o=c.link,fetch("".concat(n,"/cards"),{method:"POST",headers:r,body:JSON.stringify({name:e,link:o})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return console.log(t),t}))).then((function(t){var e=a(t,l,s,Y);j.prepend(e),p(P),V.textContent="Сохранить"})).catch((function(t){console.log(t)}))}(t)})),$.addEventListener("submit",(function(t){W.textContent="Сохранение...",function(t){var e;t.preventDefault(),(e=K.value,fetch("".concat(n,"/users/me/avatar "),{method:"PATCH",headers:r,body:JSON.stringify({avatar:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return console.log(t),t}))).then((function(t){q.style.backgroundImage="url(".concat(t.avatar,")"),p(R),W.textContent="Сохранить"})).catch((function(t){console.log(t)}))}(t)})),h=X,Array.from(document.querySelectorAll(h.formSelector)).forEach((function(t){var e=Array.from(t.querySelectorAll(h.inputSelector)),n=t.querySelector(h.submitButtonSelector);e.forEach((function(t){t.addEventListener("input",(function(r){!function(t,e){var n=document.querySelector(".".concat(e.id,"-error")),r=e.dataset.errorMessage,o=e.getAttribute("pattern"),c=new RegExp(o);e.validity.valid&&c.test(t)&&t.length>1?function(t,e){t.classList.add("input-error-non-active"),e.removeAttribute("style")}(n,e):e.validity.patternMismatch?m(r,n,e):m(e.validationMessage,n,e)}(r.target.value,t),y(e,n,h)}))})),y(e,n,h)})),S=L,b=E,g=q,Promise.all([c,u]).then((function(t){var n,r,o=(r=2,function(t){if(Array.isArray(t))return t}(n=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,c,u,i=[],a=!0,l=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{if(!a&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return i}}(n,r)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=o[0],u=o[1];return S.textContent=c.name,b.textContent=c.about,g.style.backgroundImage="url(".concat(c.avatar,")"),u.forEach((function(t){j.append(a(t,l,s,Y,c))})),[c,u]})).catch((function(t){console.log(t)}))})();